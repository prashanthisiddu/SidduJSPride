<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Dashboard</title>
    <style>
        .available-leaves {
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-top: 20px; 
        }

        .available-leaves button {
            flex: 1; 
            margin: 0 5px; 
            padding: 10px; 
            border: 1px solid #9c9d9e;
            background-color: #f9f9f9; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .leave-types {
            display: flex;
            gap: 10px; 
            flex-wrap: wrap; 
        }

        .type-card {
            border: 2px solid #007BFF; 
            padding: 10px;
            border-radius: 8px; 
            text-align: center;
            width: 150px; 
            background-color: #f9f9f9; 
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1); 
        }

        .available-leaves {
            border: 2px solid #007BFF; 
            padding: 10px;
            border-radius: 8px;
            margin-top: 20px;
            background-color: #f9f9f9;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }

        .dashboard {
            display: flex;
            justify-content: space-between;
            gap: 20px; 
        }

        .leave-balance {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 10px; 
        }

        .profile-card img {
            width: 180px;
            height: 300px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #ddd;
        }

        .profile-card h2 {
            margin-top: 10px;
            font-size: 22px;
        }

        .profile-card p {
            color: #666;
            margin: 5px 0;
        }

        .performance-container {
            width: 35%;
            display: flex;
            flex-direction: column;
            
            gap: 20px; 
        }

        .performance h2 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .performance-content {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
        }

        .performance-content p {
            color: #333;
            margin: 5px 0;
        }

        .leave-balance {
            width: 60%; 
        }

        .leave-balance h2 {
            margin-bottom: 20px;
            font-size: 20px;
        }

        .leave-types {
            display: flex;
            justify-content: space-between;
            gap: 10px; 
        }

        .leave-types .type-card {
            text-align: center;
            /* flex-basis: 18%; */
            background-color: #f8f8f8;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 5px rgba(0,0,0,0.05);
            height: 35px;
    width: 20px;
        }

        .type-card p {
            margin: 10px 0;
        }

        .available-leaves {
            margin-top: 20px;
            text-align: right;
        }

        .type-card {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 10px; 
            height: 10px; 
            background-color: #f0f0f0; 
            display: flex; 
            flex-direction: column; 
            align-items: center;
               
        }

        .type-card svg {
            
            height: auto; 
            display: flex; 
            flex-direction: column; 
            align-items: center;
               
            
        }

        .leave-types {
            display: flex;
            gap: 1px; 
            flex-wrap: wrap; 
        }

        .type-card {
            border: 2px solid #007BFF; 
            padding: 10px;
            border-radius: 2px; 
            text-align: center;
            /* width: 150px;  */
            background-color: #f9f9f9; 
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1); 
            width: 60px;  
            height: 60px;
        }

        .available-leaves {
            border: 2px solid #007BFF; 
            padding: 10px;
            border-radius: 8px;
            margin-top: 20px;
            background-color: #f9f9f9;
        }

        .leave-balance-header {
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
        }

        .leave-balance-header a {
            text-decoration: none; 
            color: #878d92; 
            font-weight: bold; 
        }
        .outer-box {
                padding: 20px;
                margin: 20px;
                /* border: 2px solid #FFA53B; */
                background-color: #F0F4F8;
                border-radius: 15px;
                display: inline-block;
                box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
                width: 50px;
                height: 65px
                
            }
            .performance-table {
    border-collapse: collapse; 
    width: 100%; 
}

.performance-table td {
    padding: 10px; 
    border: none; 
    vertical-align: top;
}

.performance-table tr {
    background-color: transparent; 
}


.performance-table span {
    font-weight: bold; 
}

    </style>
<meta></head>

<body onload="fetchOwnerAndEmployeeData()" style="overflow-wrap: break-word;">
    <div class="dashboard">
        <!-- Profile Card -->
        <div class="profile-card">
            <img id="profile-picture" alt="User Profile Picture" style=" width: 180px; height: 300px;">

        </div>

        <!-- Performance Section -->
        <div class="performance-container">
            <div class="performance">
                <div class="performance-content" style="background-color: blue;">
                    <h2 id="employee-name">Loading...</h2>
                </div>
            </div>
            <div class="performance">
                
                    <div class="performance-content">
                        <table class="performance-table">
                            <tbody><tr>
                                <td>Email:</td>
                                <td><span id="pg-email">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Dojo:</td>
                                <td><span id="pg-dojo">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Dojo Belt Level:</td>
                                <td><span id="pg-dojo-belt-level">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Dojo Degree:</td>
                                <td><span id="pg-dojo-degree">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Last Dojo Elevation:</td>
                                <td><span id="pg-dojo-last-elevated">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Manager:</td>
                                <td><span id="pg-manager">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Performance Period:</td>
                                <td><span id="pg-performance-period">Loading...</span></td>
                            </tr>
                            <tr>
                                <td>Location:</td>
                                <td><span id="user-address">Loading...</span></td>
                            </tr>
                        </tbody></table>
                    </div>
                </div>
                
            </div>
        

        <div class="leave-balance">
            <div class="leave-balance-header" style="display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0;">Leave Balance</h2>
                <a href="#">View All</a>
            </div>
    
                
                <div class="leave-types">
                    
                    <div class="outer-box" style="  padding: 20px; margin: 20px;border: 2px solid #71A3F8;background-color: #F0F4F8;border-radius: 5px;display: inline-block;box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                    ">
                    <div class="type-card" style="border:2px solid #71A3F8;background: #71A3F8 0% 0% no-repeat padding-box;
                    
                   ;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-calendar2-check" viewBox="0 0 16 16">
                            <path d="M10.854 8.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708 0"></path>
                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"></path>
                            <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5z"></path>
                        </svg>
                      
                    </div>
                    <p style="margin-top:30px; align-content: center;">Paid leave</p>
                    </div>
                   
                    <div class="outer-box" style="  padding: 20px; margin: 20px;border:2px solid palevioletred;background-color: #F0F4F8;border-radius: 15px;display: inline-block;box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                    ">
                    
                    <div class="type-card" style="border:2px solid palevioletred;background: palevioletred 0% 0% no-repeat padding-box;
                    border: 2px solid palevioletred;
                    border-radius: 10px;
                    opacity: 1;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="40" fill="currentColor" class="bi bi-calendar-x" viewBox="0 0 16 16">
                            <path d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708"></path>
                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"></path>
                        </svg>
                       
                    </div>
                    <p style="margin-top:30px; align-content: center;">unpaid leave</p>
                    </div>
                    <div class="outer-box" style="  padding: 20px; margin: 20px;border:2px solid #8A84F7;;background-color: #F0F4F8;border-radius: 15px;display: inline-block;box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                    ">
                    <div class="type-card" style="border:2px solid #8A84F7;background: #8A84F7 0% 0% no-repeat padding-box;">

                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-calendar-heart" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM1 14V4h14v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1m7-6.507c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132"></path>
                        </svg>
                       
                    </div>
                    <p style="margin-top: 10px;">Maternity/Paternity</p>
                    </div>
                    <div class="outer-box" style="  padding: 20px; margin: 20px;border:2px solid #76D8B1;;background-color: #F0F4F8;border-radius: 15px;display: inline-block;box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                    ">
            
                    <div class="type-card" style="border:2px solid #76D8B1;background: #76D8B1 0% 0% no-repeat padding-box;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-heart-pulse" viewBox="0 0 16 16">
                            <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053.918 3.995.78 5.323 1.508 7H.43c-2.128-5.697 4.165-8.83 7.394-5.857q.09.083.176.171a3 3 0 0 1 .176-.17c3.23-2.974 9.522.159 7.394 5.856h-1.078c.728-1.677.59-3.005.108-3.947C13.486.878 10.4.28 8.717 2.01zM2.212 10h1.315C4.593 11.183 6.05 12.458 8 13.795c1.949-1.337 3.407-2.612 4.473-3.795h1.315c-1.265 1.566-3.14 3.25-5.788 5-2.648-1.75-4.523-3.434-5.788-5"></path>
                            <path d="M10.464 3.314a.5.5 0 0 0-.945.049L7.921 8.956 6.464 5.314a.5.5 0 0 0-.88-.091L3.732 8H.5a.5.5 0 0 0 0 1H4a.5.5 0 0 0 .416-.223l1.473-2.209 1.647 4.118a.5.5 0 0 0 .945-.049l1.598-5.593 1.457 3.642A.5.5 0 0 0 12 9h3.5a.5.5 0 0 0 0-1h-3.162z"></path>
                          </svg>
                       
                    </div>
                    <p style="margin-top:30px; align-content: center;">Medical</p>
            </div>
            <div class="outer-box" style="  padding: 20px; margin: 20px;border:2px solid #FFA53B;background-color: #F0F4F8;border-radius: 15px;display: inline-block;box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                    ">
                    <div class="type-card" style="border:2px solid #FFA53B;background: #FFA53B 0% 0% no-repeat padding-box;
                    border: 2px solid #FFA53B;
                    border-radius: 10px;
                    opacity: 1;">
                     <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-cake2" viewBox="0 0 16 16">
                        <path d="m3.494.013-.595.79A.747.747 0 0 0 3 1.814v2.683q-.224.051-.432.107c-.702.187-1.305.418-1.745.696C.408 5.56 0 5.954 0 6.5v7c0 .546.408.94.823 1.201.44.278 1.043.51 1.745.696C3.978 15.773 5.898 16 8 16s4.022-.227 5.432-.603c.701-.187 1.305-.418 1.745-.696.415-.261.823-.655.823-1.201v-7c0-.546-.408-.94-.823-1.201-.44-.278-1.043-.51-1.745-.696A12 12 0 0 0 13 4.496v-2.69a.747.747 0 0 0 .092-1.004l-.598-.79-.595.792A.747.747 0 0 0 12 1.813V4.3a22 22 0 0 0-2-.23V1.806a.747.747 0 0 0 .092-1.004l-.598-.79-.595.792A.747.747 0 0 0 9 1.813v2.204a29 29 0 0 0-2 0V1.806A.747.747 0 0 0 7.092.802l-.598-.79-.595.792A.747.747 0 0 0 6 1.813V4.07c-.71.05-1.383.129-2 .23V1.806A.747.747 0 0 0 4.092.802zm-.668 5.556L3 5.524v.967q.468.111 1 .201V5.315a21 21 0 0 1 2-.242v1.855q.488.036 1 .054V5.018a28 28 0 0 1 2 0v1.964q.512-.018 1-.054V5.073c.72.054 1.393.137 2 .242v1.377q.532-.09 1-.201v-.967l.175.045c.655.175 1.15.374 1.469.575.344.217.356.35.356.356s-.012.139-.356.356c-.319.2-.814.4-1.47.575C11.87 7.78 10.041 8 8 8c-2.04 0-3.87-.221-5.174-.569-.656-.175-1.151-.374-1.47-.575C1.012 6.639 1 6.506 1 6.5s.012-.139.356-.356c.319-.2.814-.4 1.47-.575M15 7.806v1.027l-.68.907a.94.94 0 0 1-1.17.276 1.94 1.94 0 0 0-2.236.363l-.348.348a1 1 0 0 1-1.307.092l-.06-.044a2 2 0 0 0-2.399 0l-.06.044a1 1 0 0 1-1.306-.092l-.35-.35a1.935 1.935 0 0 0-2.233-.362.935.935 0 0 1-1.168-.277L1 8.82V7.806c.42.232.956.428 1.568.591C3.978 8.773 5.898 9 8 9s4.022-.227 5.432-.603c.612-.163 1.149-.36 1.568-.591m0 2.679V13.5c0 .006-.012.139-.356.355-.319.202-.814.401-1.47.576C11.87 14.78 10.041 15 8 15c-2.04 0-3.87-.221-5.174-.569-.656-.175-1.151-.374-1.47-.575-.344-.217-.356-.35-.356-.356v-3.02a1.935 1.935 0 0 0 2.298.43.935.935 0 0 1 1.08.175l.348.349a2 2 0 0 0 2.615.185l.059-.044a1 1 0 0 1 1.2 0l.06.044a2 2 0 0 0 2.613-.185l.348-.348a.94.94 0 0 1 1.082-.175c.781.39 1.718.208 2.297-.426"></path>
                      </svg>
                        
                    </div>
                    <h5 style="margin-top:30px; align-content: center;">Birthday Leave</h5>
            </div>
            <div class="outer-box" style="padding: 20px; margin: 20px; border: 2px solid #1EA6D3; border-radius: 15px; display: inline-block; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center;">
                <div class="type-card" style="border: 2px solid #1EA6D3; background-color: #1EA6D3; border-radius: 15px; display: inline-block; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                  <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-suitcase" viewBox="0 0 16 16">
                    <path d="M6 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 6 5m2 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m2 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 10 5"></path>
                    <path d="M6.5 0a.5.5 0 0 0-.5.5V3H5a2 2 0 0 0-2 2v8a2 2 0 0 0 1.031 1.75A1.003 1.003 0 0 0 5 16a1 1 0 0 0 1-1h4a1 1 0 1 0 1.969-.25A2 2 0 0 0 13 13V5a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-.5-.5zM9 3H7V1h2zm3 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"></path>
                  </svg>
                </div>
              
              
                <p style="margin: 0; text-align: center; display: inline;">Other</p>
            </div>
            </div>
                <div class="available-leaves" style="border:2px solid white; margin-top: 20px;">
                    <button id="total_available">Total Available:</button>
                    <button id="total_used">Total Used:</button>
                </div>
                </div>
                   
</div>
    <script>
        
         debugger;
       
        var userId = window.parent.Xrm.Utility.getGlobalContext().userSettings.userId.replace(/[{}]/g, "");
        console.log(userId, "u_id")
        var roles=window.parent.Xrm.Utility.getGlobalContext().userSettings.roles
        console.log(roles)
        function fetchOwnerAndEmployeeData() {
            var req = new XMLHttpRequest();
            
           
            var apiUrl = window.parent.Xrm.Page.context.getClientUrl() + "/api/data/v9.1/systemusers(" + userId + ")?$select=systemuserid";
            console.log(apiUrl ,"api")
            
            req.open("GET", apiUrl, true);

            
            req.setRequestHeader("OData-MaxVersion", "4.0");
            req.setRequestHeader("OData-Version", "4.0");
            req.setRequestHeader("Accept", "application/json");
            req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

            req.onreadystatechange = function () {
                if (this.readyState === 4) {
                    req.onreadystatechange = null;

                    if (this.status === 200) {
                       
                        var result = JSON.parse(this.responseText);
                        var ownerId = result.systemuserid;

                        fetchUserProfilePicture(userId)
                        UserAddress(userId);
                        
                        fetchNewEmployeesByOwner(ownerId);
                        LeavebalanceByOwnerId(ownerId)

                    } else {
                        console.error("Error fetching owner data: " + this.statusText);
                    }
                }
            };

           
            req.send();
        }
    function fetchUserProfilePicture(userId) {
    var req = new XMLHttpRequest();
     debugger;
   
    var apiUrl = window.parent.Xrm.Page.context.getClientUrl() + "/api/data/v9.1/systemusers(" + userId + ")?$select=entityimage";

    
    req.open("GET", apiUrl, true);

    req.setRequestHeader("OData-MaxVersion", "4.0");
    req.setRequestHeader("OData-Version", "4.0");
    req.setRequestHeader("Accept", "application/json");
    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

  
    req.onreadystatechange = function () {
        if (this.readyState === 4) {
            req.onreadystatechange = null;

            if (this.status === 200) {
                
                var result = JSON.parse(this.responseText);
                var profileImageBase64 = result.entityimage;

                if (profileImageBase64) {
                    
                    document.getElementById('profile-picture').src = "data:image/jpeg;base64," + profileImageBase64;
                } else {
                    console.warn("Profile picture not available for this user.");
                    document.getElementById('profile-picture').src = "path-to-default-image.jpg";  
                }
            } else {
                console.error("Error fetching user profile picture: " + this.statusText);
            }
        }
    };

    
    req.send();
    }
    function UserAddress(userId) {
    var req = new XMLHttpRequest();
    var apiUrl = window.parent.Xrm.Page.context.getClientUrl() + "/api/data/v9.1/systemusers(" + userId + ")?$select=address1_line1,address1_city,address1_stateorprovince,address1_postalcode,address1_country";

    req.open("GET", apiUrl, true);

    req.setRequestHeader("OData-MaxVersion", "4.0");
    req.setRequestHeader("OData-Version", "4.0");
    req.setRequestHeader("Accept", "application/json");
    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

    req.onreadystatechange = function () {
        if (this.readyState === 4) {
            req.onreadystatechange = null;

            if (this.status === 200) {
                var result = JSON.parse(this.responseText);
                
                var addressLine1 = result.address1_line1;
                var city = result.address1_city;
                var state = result.address1_stateorprovince;
                var postalCode = result.address1_postalcode;
                var country = result.address1_country;

                if (addressLine1 || city || state || postalCode || country) {
                    var fullAddress = 
                        (addressLine1 ? addressLine1 + ", " : "") + 
                        (city ? city + ", " : "") + 
                        (state ? state + ", " : "") + 
                        (postalCode ? postalCode + ", " : "") + 
                        (country ? country : "");

                    document.getElementById('user-address').textContent = fullAddress;
                } else {
                    console.warn("Address not available for this user.");
                    document.getElementById('user-address').textContent = "Address not available";
                }
            } else {
                console.error("Error fetching user address: " + this.statusText);
            }
        }
    };

    req.send();
}

        function fetchNewEmployeesByOwner(ownerId) {
            var req = new XMLHttpRequest();

           
            var apiUrl = window.parent.Xrm.Page.context.getClientUrl() + "/api/data/v9.1/new_employees?$filter=_ownerid_value eq " + ownerId + "&$select=emailaddress,new_name,pg_dojo,pg_dojobeltlevel,pg_dojodegree,pg_dojolastelevated,_pg_manager_value,pg_performanceperiod";
            
            req.open("GET", apiUrl, true);

            
            req.setRequestHeader("OData-MaxVersion", "4.0");
            req.setRequestHeader("OData-Version", "4.0");
            req.setRequestHeader("Accept", "application/json");
            req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

            
            req.onreadystatechange = function () {
                if (this.readyState === 4) {
                    req.onreadystatechange = null;

                    if (this.status === 200) {
                        
                        var employeesData = JSON.parse(this.responseText).value;
                        

                        
                        employeesData.forEach(function(employee) {
                        
document.getElementById('employee-name').textContent = employee.new_name;
document.getElementById('pg-email').textContent = employee.emailaddress;
document.getElementById('pg-dojo').textContent = employee.pg_dojo;
document.getElementById('pg-dojo-belt-level').textContent = employee.pg_dojobeltlevel;
document.getElementById('pg-dojo-degree').textContent = employee.pg_dojodegree;


const lastElevatedDate = new Date(employee.pg_dojolastelevated); 
const options = { year: 'numeric', month: 'long', day: 'numeric' };
const formattedLastElevatedDate = lastElevatedDate.toLocaleDateString('en-US', options);
document.getElementById('pg-dojo-last-elevated').textContent = formattedLastElevatedDate;


document.getElementById('pg-performance-period').textContent = employee.pg_performanceperiod;
document.getElementById('pg-manager').textContent = employee._pg_manager_value;


console.log(employee._pg_manager_value);

                            

                        });
                    } else {
                        console.error("Error fetching employees data: " + this.statusText);
                    }
                }
            };

           
            req.send();
        }
        function LeavebalanceByOwnerId(ownerId) {
            var req = new XMLHttpRequest();

           
            var apiUrl = window.parent.Xrm.Page.context.getClientUrl() + "/api/data/v9.1/pg_leavebalances?$filter=_ownerid_value eq " + ownerId + "&$select=_ownerid_value,pg_name,pg_totalavailablehours,pg_totalused";
            req.open("GET", apiUrl, true);

            
            req.setRequestHeader("OData-MaxVersion", "4.0");
            req.setRequestHeader("OData-Version", "4.0");
            req.setRequestHeader("Accept", "application/json");
            req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

            
            req.onreadystatechange = function () {
                if (this.readyState === 4) {
                    req.onreadystatechange = null;

                    if (this.status === 200) {
                        
                        var employeesData = JSON.parse(this.responseText).value;
                        

                        
                        employeesData.forEach(function(Balance) {
                            document.getElementById('total_available').textContent = Balance.pg_totalavailablehours ;
                            document.getElementById('total_used').textContent = Balance.pg_totalused ;
                            console.log(Balance.pg_totalavailablehours)
                           

                        });
                    } else {
                        console.error("Error fetching employees data: " + this.statusText);
                    }
                }
            };

           
            req.send();
        }

       
        fetchOwnerAndEmployeeData();
    </script>

</body></html>